class DialpadSiteManager{initialize=()=>{this.sendQueue=new SendQueue,this.sendQueue.initialize("Dialpad",this.getSendExecutionQueue,this.verifyAccount,this.verifyNumberReady)};verifyNumberReady=()=>!window.location.href.includes("/login")&&!window.location.href.includes("/reactivateaccount");verifyAccount=e=>!!e?.subscriptionsByProduct?.Dialpad?.length;getSendExecutionQueue=()=>{var e=[this.verifyPageReady,this.showNumberInput,this.copyMessageNumbers,this.fillNumberInput,this.startChat,this.verifyRecipientCount,this.uploadPhoto,this.checkIfPhotoUploadFinished,this.writeMessage,this.sendMessage,this.confirmSent],t=[this.verifyPageReady,this.showNumberInput,this.copyMessageNumbers,this.fillNumberInput,this.startChat,this.verifyRecipientCount,this.writeMessage,this.sendMessage,this.confirmSent];return this.sendQueue.currentMessageSending.photoBase64?e:t};verifyPageReady=()=>{var e=document.querySelector(".preboot-preloader, .swoosh");return!e||null===e.offsetParent&&"none"===e.style.display};showNumberInput=()=>{var e=document.querySelector('button[data-qa="header-cta-message"]');if(e&&null!==e.offsetParent)return simulateClick(e),!0};copyMessageNumbers=()=>(this.sendQueue.currentMessageSending.phoneNumberQueue=[...this.sendQueue.currentMessageSending.phoneNumbers],!0);fillNumberInput=()=>{var e=document.querySelector("#search-input");if(e&&null!==e.offsetParent)return e.value=this.sendQueue.currentMessageSending.phoneNumberQueue[0],e.innerText=this.sendQueue.currentMessageSending.phoneNumberQueue[0],emitEvent(e,"input"),(e=document.querySelector("#phone-number"))&&e.innerText===this.sendQueue.currentMessageSending.phoneNumberQueue[0]};startChat=()=>{var e=document.querySelector("#phone-number");if(e&&null!==e.offsetParent)return simulateClick(e),this.sendQueue.currentMessageSending.phoneNumberQueue.shift(),0<this.sendQueue.currentMessageSending.phoneNumberQueue.length&&(this.sendQueue.currentSendExecutionQueue.unshift(this.startChat),this.sendQueue.currentSendExecutionQueue.unshift(this.fillNumberInput)),!0};verifyRecipientCount=()=>{if(this.sendQueue.currentMessageSending.phoneNumbers.length===document.querySelectorAll(".rt-name.iblock").length)return!0};writeMessage=()=>{var e,t;return!!this.sendQueue.currentMessageSending.text&&(e=this.sendQueue.currentMessageSending.text,(t=document.querySelector('div[data-qa="message-input"] div[data-qa="dt-rich-text-editor"] div[role="textbox"], #message-text'))&&null!==t.offsetParent?(t.value=e,t.innerText=e,emitEvent(t,"input"),!0):void 0)};sendMessage=()=>{var e=document.querySelector('div[data-qa="message-input"] div[data-qa="dt-rich-text-editor"] div[role="textbox"], #message-text');if(e&&!this.sendQueue.abortSend)return simulateKeyPress(e,"Enter",13),!0};confirmSent=()=>{var e,t=document.querySelector('div[data-qa="feed-item-error-sending"]');return(!t||null===t.offsetParent)&&((!(t=document.querySelector(".feed-list-progress-bar__slider"))||null===t.offsetParent||"100%"===t.style?.width)&&(t=Array.from(document.querySelectorAll(".d-ws-pre-wrap")).map(e=>e.innerText).join(),e=removeWhitespace(removeNonAscii(this.sendQueue.currentMessageSending.text)),!!removeWhitespace(removeNonAscii(t)).includes(e))||void 0)};uploadPhoto=async()=>{var e=this.sendQueue.currentMessageSending.photoBase64,t=document.querySelector('div[data-qa="message-input"] div[data-qa="dt-rich-text-editor"] div[role="textbox"], #message-text');return simulateImageDrop(t,e),!0};checkIfPhotoUploadFinished=()=>{var e=document.querySelector('div[data-qa="media-thumbnail"] img, .mpr-mms-preview.mpr-img');if(e&&null!==e.offsetParent)return!0}}(new DialpadSiteManager).initialize();
