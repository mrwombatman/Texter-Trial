class ZoomSiteManager{initialize=()=>{this.sendQueue=new SendQueue,this.sendQueue.initialize("Zoom",this.getSendExecutionQueue,this.verifyAccount,this.verifyNumberReady)};verifyNumberReady=()=>{return!document.querySelector("button.btn-index-signin")&&!document.querySelector('div[class^="CanNotShowZoomPhone"],p[class^="CanNotShowZoomPhone"]')};verifyAccount=e=>!!e?.subscriptionsByProduct?.Zoom?.length;getSendExecutionQueue=()=>{var e=[this.verifyPageReady,this.showTextingTab,this.showNumberInput,this.copyMessageNumbers,this.fillNumberInput,this.startChat,this.verifyRecipientCount,this.uploadPhoto,this.checkIfPhotoUploadFinished,this.writeMessage,this.sendMessage,this.confirmSent],t=[this.verifyPageReady,this.showTextingTab,this.showNumberInput,this.copyMessageNumbers,this.fillNumberInput,this.startChat,this.verifyRecipientCount,this.writeMessage,this.sendMessage,this.confirmSent];return this.sendQueue.currentMessageSending.photoBase64?e:t};verifyPageReady=()=>{var e=document.querySelector(".zmicon.zmicon-spin");return!e||null===e.offsetParent&&"none"===e.style.display};showTextingTab=()=>{var e=document.querySelector("div#SMS");if(e&&null!==e.offsetParent)return simulateClick(e),!0};showNumberInput=()=>{var e=document.querySelector('button[data-testid="new-sms"]');if(e&&null!==e.offsetParent)return simulateClick(e),!0};copyMessageNumbers=()=>(this.sendQueue.currentMessageSending.phoneNumberQueue=[...this.sendQueue.currentMessageSending.phoneNumbers],!0);fillNumberInput=()=>{var e=document.querySelector('input[data-testid="to:"]');if(e&&null!==e.offsetParent)return simulateClick(e),e.focus(),emitFocusEvent(e,"focusin"),e.value=this.sendQueue.currentMessageSending.phoneNumberQueue[0],simulateKeyPress(e),emitEvent(e,"change"),emitEvent(e,"input"),!0};startChat=()=>{var e=document.querySelector('input[data-testid="to:"]'),e=(emitEvent(e,"change"),emitFocusEvent(e,"blur"),emitFocusEvent(e,"focusout"),document.querySelectorAll('div[data-testid="sms-contact-wrapper"]')),e=e?.[e.length-1];if(e&&simplifyNumber(e.innerText)===simplifyNumber(this.sendQueue.currentMessageSending.phoneNumberQueue[0]))return this.sendQueue.currentMessageSending.phoneNumberQueue.shift(),0<this.sendQueue.currentMessageSending.phoneNumberQueue.length&&(this.sendQueue.currentSendExecutionQueue.unshift(this.startChat),this.sendQueue.currentSendExecutionQueue.unshift(this.fillNumberInput)),!0};verifyRecipientCount=()=>{if(this.sendQueue.currentMessageSending.phoneNumbers.length===document.querySelectorAll('div[data-testid="sms-contact-wrapper"]').length)return!0};writeMessage=()=>{var e,t;return!!this.sendQueue.currentMessageSending.text&&(e=this.sendQueue.currentMessageSending.text,(t=document.querySelector('textarea[data-testid="sms-input"]'))&&null!==t.offsetParent?(t.value=e,t.innerText=e,emitEvent(t,"input"),!0):void 0)};sendMessage=()=>{var e=document.querySelector("div.sms-bottom-toolbar button.z-button-type-primary");if(e&&!this.sendQueue.abortSend)return simulateClick(e),!0};confirmSent=()=>{var e,t=document.querySelector('i[data-testid="message-inflight"]');if(!t||null===t.offsetParent)return(!(t=document.querySelector('i[data-testid="fail-indicator"], div[data-testid="failed-message"]'))||null===t.offsetParent)&&(t=Array.from(document.querySelectorAll('div[data-testid="transcript-rows"] .message-text')).map(e=>e.innerText).join(),e=removeWhitespace(removeNonAscii(this.sendQueue.currentMessageSending.text)),!!removeWhitespace(removeNonAscii(t)).includes(e)||void 0)};uploadPhoto=async()=>{var e,t=base64toFile(this.sendQueue.currentMessageSending.photoBase64,"photoUpload.png"),n=document.querySelector('input[hidden][type="file"]');if(n)return(e=new DataTransfer).items.add(t),n.files=e.files,emitEvent(n,"change"),!0};checkIfPhotoUploadFinished=()=>{var e=document.querySelector("div.staged-image-container img");if(e&&null!==e.offsetParent)return!0}}(new ZoomSiteManager).initialize();
