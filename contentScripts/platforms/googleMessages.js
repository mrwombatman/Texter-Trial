class GoogleMessagesSiteManager{initialize=()=>{this.selectors={gmLoadingIcon:"#loader",gmNumInputButton:"a[data-e2e-start-button]",gmNumInput:"input[data-e2e-contact-input]",gmStartChatButton:"button[data-e2e-send-to-button]",gmAddMorePeople:"button[data-e2e-add-more-people]",gmGroupTextNextButton:"button[data-e2e-next-button]",gmRecipientCard:"mat-chip-listbox mat-chip-option",gmUpdatingChatLoader:"mws-spinner:not(.hide)",gmChatLoadedHeader:"mws-header[data-e2e-conversation-header]",gmMessageEditor:"textarea[data-e2e-message-input-box]",gmSendButton:"button[data-e2e-send-text-button]",gmSendingNote:"[data-e2e-sending-status-icon]",gmMostRecentMessages:"div[data-e2e-text-message-content] div.text-msg.msg-content div.ng-star-inserted",gmAttachedImage:"mws-attachment-item[data-e2e-attachment-item]"},this.sendQueue=new SendQueue,this.sendQueue.initialize("Android",this.getSendExecutionQueue,this.verifyAccount,this.verifyNumberReady)};verifyNumberReady=()=>{return!(window.location.href.includes("/welcome")||window.location.href.includes("/authentication")||window.location.href.includes("/messagesSetup"))&&(!!document.querySelector(this.selectors.gmNumInputButton)||void 0)};verifyAccount=e=>!!e?.subscriptionsByProduct?.Android?.length;getSendExecutionQueue=()=>{var e=[this.verifyPageReady,this.showNumberInput,this.copyMessageNumbers,this.fillNumberInput,this.startChat,this.confirmChatSwitched,this.uploadPhoto,this.checkIfPhotoUploadFinished,this.writeMessage,this.sendMessage,this.confirmThreadHeaderUpdated,this.confirmSent],t=[this.verifyPageReady,this.showNumberInput,this.copyMessageNumbers,this.fillNumberInput,this.startChat,this.confirmChatSwitched,this.writeMessage,this.sendMessage,this.confirmThreadHeaderUpdated,this.confirmSent];return this.sendQueue.currentMessageSending.photoBase64?[...e]:t};verifyPageReady=()=>{var e=document.querySelector(this.selectors.gmLoadingIcon);return!e||null===e.offsetParent};showNumberInput=()=>{var e=document.querySelector(this.selectors.gmNumInputButton);if(e&&null!==e.offsetParent)return simulateClick(e),!0};copyMessageNumbers=()=>(this.sendQueue.currentMessageSending.phoneNumberQueue=[...this.sendQueue.currentMessageSending.phoneNumbers],!0);clickAddMorePeople=()=>{var e=document.querySelector(this.selectors.gmAddMorePeople);if(e&&null!==e.offsetParent)return simulateClick(e),!0};fillNumberInput=()=>{var e=document.querySelector(this.selectors.gmNumInput);if(e&&null!==e.offsetParent)return e.value=this.sendQueue.currentMessageSending.phoneNumberQueue[0],emitEvent(e,"input"),(e=document.querySelector(this.selectors.gmNumInput))&&e.value===this.sendQueue.currentMessageSending.phoneNumberQueue[0]};startChat=()=>{var e=document.querySelector(this.selectors.gmStartChatButton);if(e&&null!==e.offsetParent)return simulateClick(e),this.sendQueue.currentMessageSending.phoneNumberQueue.shift(),1===this.sendQueue.currentMessageSending.phoneNumberQueue.length&&(this.sendQueue.currentSendExecutionQueue.unshift(this.clickGroupTextNextButton),this.sendQueue.currentSendExecutionQueue.unshift(this.verifyRecipientCount)),0<this.sendQueue.currentMessageSending.phoneNumberQueue.length&&(this.sendQueue.currentSendExecutionQueue.unshift(this.startChat),this.sendQueue.currentSendExecutionQueue.unshift(this.fillNumberInput),this.sendQueue.currentMessageSending.phoneNumberQueue.length===this.sendQueue.currentMessageSending.phoneNumbers.length-1)&&this.sendQueue.currentSendExecutionQueue.unshift(this.clickAddMorePeople),!0};verifyRecipientCount=()=>{if(this.sendQueue.currentMessageSending.phoneNumbers.length===document.querySelectorAll(this.selectors.gmRecipientCard).length)return!0};clickGroupTextNextButton=()=>{var e=document.querySelector(this.selectors.gmGroupTextNextButton);if(e&&null!==e.offsetParent)return simulateClick(e),!0};confirmChatSwitched=()=>{var e=document.querySelector(this.selectors.gmUpdatingChatLoader);if(!e||null===e.offsetParent)return!(!(e=document.querySelector(this.selectors.gmChatLoadedHeader))||null===e.offsetParent)||void 0};writeMessage=()=>{var e,t;return!!this.sendQueue.currentMessageSending.text&&(e=this.sendQueue.currentMessageSending.text,(t=document.querySelector(this.selectors.gmMessageEditor))&&null!==t.offsetParent?(t.value=e,t.innerText=e,emitEvent(t,"input"),!0):void 0)};sendMessage=()=>{var e;return document.querySelector(this.selectors.gmMessageEditor)&&!this.sendQueue.abortSend&&(e=document.querySelector(this.selectors.gmSendButton))&&!1===e.disabled?(emitEvent(e,"sendClicked"),!0):void 0};confirmThreadHeaderUpdated=()=>{if(!document.querySelector(this.selectors.gmAddMorePeople))return!0};confirmSent=()=>{if(!document.querySelector(this.selectors.gmSendingNote)){var n=document.querySelectorAll(this.selectors.gmMostRecentMessages);let t=!1;if(n&&n.length){let e=n.length-1;for(e;!t&&0<=e;e--){var s=removeWhitespace(removeNonAscii(this.sendQueue.currentMessageSending.text)),u=removeWhitespace(removeNonAscii(n[n.length-1].innerText));t=u===s}}if(t)return!0}};uploadPhoto=async()=>{var e=this.sendQueue.currentMessageSending.photoBase64,t=document.querySelector("body");return simulateImageDrop(t,e),!0};checkIfPhotoUploadFinished=()=>{if(document.querySelector(this.selectors.gmAttachedImage))return!0}}(new GoogleMessagesSiteManager).initialize();
