var browser_polyfill;function getFunctionName(e){return e.name.replace(/bound /g,"")}"undefined"!=typeof browser?browser_polyfill=browser:"undefined"!=typeof chrome&&(browser_polyfill=chrome);let timeoutsToProcess={};function setBackgroundTimeout(e,t){var n=uuidV4();timeoutsToProcess[n]=e,passMessage("SET_TIMEOUT",{timeoutId:n,timeoutDuration:t})}async function keepTrying(e,t){const n=getFunctionName(e);function o(){var e;if(!t)throw e=`Text failed. Error in v${browser_polyfill.runtime.getManifest().version}: "${n}" failed.`,new Error(e)}let r=5e3/300;"sendMessage"!==n&&"sendPhoto"!==n||await sleep(2e3);for(var i=r="confirmSent"!==n&&"confirmThreadHeaderUpdated"!==n&&"confirmPhotoSent"!==n?r:2e4/300;0<r--;){await sleep(300),3<=i-r&&playQuietSound(),console.log("BulkTexterPro: Running: ",n);var s=await e();if(!0===s)return!0;if(!1===s)return o(),s}return o(),!1}function removeNonAscii(e){return e.replace(/[^\x00-\x7F]/g,"")}function removeWhitespace(e){return e.replace(/\s/g,"")}function simplifyString(e){return e.toLowerCase().replace(/\W/g,"")}function simplifyNumber(e){return(""+e).trim().replace(/[^0-9+]/g,"")}function sleep(t){return new Promise(e=>setBackgroundTimeout(e,t))}async function getUser(){return(await browser_polyfill.storage.sync.get("BulkTexterPro_User")).BulkTexterPro_User}async function passMessage(e,t){let n;var o=new Promise(e=>{n=e});return browser_polyfill.runtime.sendMessage({bulk_texter_pro:!0,eventType:e,payload:t},e=>{n(e)}),o}browser_polyfill.runtime.onMessage.addListener((e,t,n)=>{if("TIMEOUT_FINISHED"===e.eventType)return e=e?.payload?.timeoutId,timeoutsToProcess[e]&&(timeoutsToProcess[e](),delete timeoutsToProcess[e]),n(!0)});const simulateMouseEvent=(e,t,n,o)=>{e.dispatchEvent(new MouseEvent(t,{view:window,bubbles:!0,cancelable:!0,clientX:n,clientY:o,button:0}))},simulateClick=e=>{var t=e.getBoundingClientRect(),n=t.left+(t.right-t.left)/2,t=t.top+(t.bottom-t.top)/2;simulateMouseEvent(e,"mousedown",n,t),simulateMouseEvent(e,"mouseup",n,t),simulateMouseEvent(e,"click",n,t)},simulateKeyPress=(e,t,n)=>{e.dispatchEvent(new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,key:t,code:t,which:n,keyCode:n})),e.dispatchEvent(new KeyboardEvent("keyup",{bubbles:!0,cancelable:!0,key:t,code:t,which:n,keyCode:n}))},simulateImageDrop=(e,t)=>{var t=base64toFile(t,"photoUpload.png"),n=new DataTransfer;n.items.add(t),e.dispatchEvent(new DragEvent("drop",{dataTransfer:n,bubbles:!0,cancelable:!0}))},emitEvent=(e,t)=>{e.dispatchEvent(new Event(t,{bubbles:!0,cancelable:!0}))},emitFocusEvent=(e,t)=>{e.dispatchEvent(new FocusEvent(t,{bubbles:!0,cancelable:!0}))},getCookie=e=>{e=("; "+document.cookie).split(`; ${e}=`);if(2===e.length)return e.pop().split(";").shift()};function base64toFile(e,t){let n=e.split(","),o=n[0].match(/:(.*?);/)[1],r=atob(n[1]),i=r.length,s=new Uint8Array(i);for(;i--;)s[i]=r.charCodeAt(i);return new File([s],t,{type:o})}function uuidV4(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))}function playQuietSound(){console.log("BulkTexterPro: Playing beep sound.");var e=new(window.AudioContext||window.webkitAudioContext);const t=e.createOscillator();t.type="sine",t.frequency.setValueAtTime(440,e.currentTime);var n=e.createGain();n.gain.setValueAtTime(1e-4,e.currentTime),t.connect(n),n.connect(e.destination),t.start(),setBackgroundTimeout(()=>{t.stop()},200)}
